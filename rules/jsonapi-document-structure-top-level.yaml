# Document Structure - Top Level
# https://jsonapi.org/format/#document-top-level

# all rules in this file MUST have corresponding tests

rules:
  top-level-request-json-object:
    description: "A JSON object MUST be at the root of every JSON:API request body containing data."
    documentationUrl: https://jsonapi.org/format/#document-top-level
    message: "{{path}} - {{description}}"
    severity: error
    given: $.paths.[*].requestBody.content[?(@property === 'application/vnd.api+json')].schema
    then:
      field: 'type'
      function: enumeration
      functionOptions:
        values:
          - object